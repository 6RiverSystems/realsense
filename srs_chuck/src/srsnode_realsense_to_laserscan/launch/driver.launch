<!-- 
  *
  * (c) Copyright 2015-2016 River Systems, all rights reserved.
  *
  * This is proprietary software, unauthorized distribution is not permitted.
  *
-->
<launch>
	<arg name="camera" default="camera" />
	<arg name="simulation" default="false" />

        <remap from="/camera/color/camera_info" to="/internal/sensors/rgbd/color/camera_info"/>
        <remap from="/camera/color/image_raw" to="/internal/sensors/rgbd/color/image_raw"/>
        <remap from="/camera/depth/camera_info" to="/internal/sensors/rgbd/depth/camera_info"/>
        <remap from="/camera/depth/image_raw" to="/internal/sensors/rgbd/depth/image_raw"/>
	<remap from="/camera/depth/points" to="/internal/sensors/rgbd/depth/points/filtered"/>
        <remap from="/camera/depth/points_raw" to="/internal/sensors/rgbd/depth/points/raw"/>
        <remap from="/camera/ir/camera_info" to="/internal/sensors/rgbd/ir/camera_info"/>
        <remap from="/camera/ir/image_raw" to="/internal/sensors/rgbd/ir/image_raw"/>
        <remap from="/camera/ir2/camera_info" to="/internal/sensors/rgbd/ir2/camera_info"/>
        <remap from="/camera/ir2/image_raw" to="/internal/sensors/rgbd/ir2/image_raw"/>
        <remap from="/camera/nodelet_manager/bond" to="/internal/sensors/rgbd/nodelet_manager/bond"/>
	<param name="$(arg camera)/driver/r200_dc_preset"   type="int"  value="5" />

	<!-- Intel Realsense R200 driver -->
	<include file="$(find realsense_camera)/launch/r200_nodelet_modify_params.launch" >
        <arg name="enable_color" value="false" />
        <arg name="enable_tf" value="false" />
        </include>
	
        <!-- Point cloud to laser scan conversion -->
	<node pkg="pointcloud_to_laserscan" type="pointcloud_to_laserscan_node" name="pointcloud_to_laserscan">

        <remap from="cloud_in" to="/internal/sensors/rgbd/depth/points/filtered"/>
        <remap from="scan" to="/internal/sensors/rgbd/scan"/>
        <rosparam>
            target_frame: laser_frame # Leave disabled to output scan in pointcloud frame
            transform_tolerance: 0.05
            min_height: 0.03
            max_height: 3.0

            angle_min: -1.5708 # -M_PI/2
            angle_max: 1.5708 # M_PI/2
            angle_increment: 0.008 # M_PI/360.0
            scan_time: 0.3333
            range_min: 0.3
            range_max: 8.0
            use_inf: true

            # Concurrency level, affects number of pointclouds queued for processing, thread number governed by nodelet manager
            # 0 : Detect number of cores
            # 1 : Single threaded
            # 2->inf : Parallelism level
            concurrency_level: 0
        </rosparam>
        </node>

        <node pkg="laser_filters" type="scan_to_scan_filter_chain" output="screen" name="rgbd_laser_filter">
	<remap from="scan" to="/internal/sensors/rgbd/scan" />
	<remap from="scan_filtered" to="/internal/sensors/rgbd/scan/filtered" />
	<rosparam command="load" file="$(find srsnode_laser_filters)/config/laser_filter.yaml" />
	</node>
        

</launch>

