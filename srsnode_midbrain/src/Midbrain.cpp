/*
 * (c) Copyright 2015-2016 River Systems, all rights reserved.
 *
 * This is proprietary software, unauthorized distribution is not permitted.
 */

#include <srsnode_midbrain/Midbrain.hpp>

#include <ros/ros.h>
#include <geometry_msgs/Twist.h>

namespace srs {

////////////////////////////////////////////////////////////////////////////////////////////////////
// Public methods

////////////////////////////////////////////////////////////////////////////////////////////////////
Midbrain::Midbrain(string name, int argc, char** argv) :
    RosUnit(name, argc, argv, REFRESH_RATE_HZ)
{
}

////////////////////////////////////////////////////////////////////////////////////////////////////
void Midbrain::execute()
{
    evaluateTriggers();
    reflexes_.execute();
}

////////////////////////////////////////////////////////////////////////////////////////////////////
void Midbrain::initialize()
{
    // Nothing to initialize
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// Private methods

////////////////////////////////////////////////////////////////////////////////////////////////////
void Midbrain::evaluateTriggers()
{
    if (triggerShutdown_.isTriggerRequested())
    {
        ROS_WARN("SHUTDOWN TRIGGER");
        ros::shutdown();
    }
}

} // namespace srs
